---
title: "male-deconstructed"
author: "Di"
date: "2023-10-15"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(survival)
library(forestplot)
library(grid)
library(checkmate)
library(abind)
library(broom)
library(stringr)

directory_path = "D:\\DiXi\\data preparation\\environmental info\\single events identification\\heat and cold\\using threshold 5 years prior to exposure\\revision 2\\strata prov\\sex specific analysis"
```



```{r get sexdeconstruct}
getSexDetail = function(df, stratify_var, def, def_sex){

    
  stratify_levels <- as.character(na.omit(unique(df[[stratify_var]])))
  stratify_levels <- stratify_levels[!(stratify_levels %in% c("don't know", "missing"))]#; stratify_levels

    
    results = list()
    for (level in stratify_levels) {
      
      df %>% filter(sex == def_sex) -> df
      subset_data <- subset(df, df[[stratify_var]] == level)
    
      # Fit the Cox model
      f <- paste0('Surv(tstart, times, event.death) ~ hwd.ind + trueage + sex + strata(prov) + cluster(id)')
      f = as.formula(f)
      coxfit <- coxph(f, data = subset_data)
    
      # Store the model results
      result <- coxfit %>% tidy(conf.int = TRUE, exponentiate = TRUE)
      
      results[[level]] <- result
    }
    
    saveRDS(results, paste0(def, '_', stratify_var, '.rds'))
    

    
    return(results)
}
```



==================================================================================================================
========================================== sex deonstructed - demo =================================================
================================================================================================================

```{r agegroup}
#### female ####
setwd(paste0(directory_path, '\\female\\agegroup'))
# 
# getSexDetail(HW1_CMA_full, 'agegroup', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'agegroup', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'agegroup', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'agegroup', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'agegroup', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'agegroup', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'agegroup', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'agegroup', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'agegroup', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'agegroup', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\agegroup'))
# combineResults(paste0(directory_path, '\\female\\agegroup'), '/70','70.csv')
# combineResults(paste0(directory_path, '\\female\\agegroup'), '/80','80.csv')
# combineResults(paste0(directory_path, '\\female\\agegroup'), '/90','90.csv')
# combineResults(paste0(directory_path, '\\female\\agegroup'), '/100','100.csv')

#### male ####
setwd(paste0(directory_path, '\\male\\agegroup'))

# getSexDetail(HW1_CMA_full, 'agegroup', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'agegroup', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'agegroup', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'agegroup', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'agegroup', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'agegroup', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'agegroup', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'agegroup', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'agegroup', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'agegroup', 'HW10', 'male')

# getCSV(paste0(directory_path, '\\male\\agegroup'))
# combineResults(paste0(directory_path, '\\male\\agegroup'), '/70','70.csv')
# combineResults(paste0(directory_path, '\\male\\agegroup'), '/80','80.csv')
# combineResults(paste0(directory_path, '\\male\\agegroup'), '/90','90.csv')
# combineResults(paste0(directory_path, '\\male\\agegroup'), '/100','100.csv')



```


```{r UorR}
#### female ####
setwd(paste0(directory_path, '\\female\\UorR'))

# getSexDetail(HW1_CMA_full, 'UorR', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'UorR', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'UorR', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'UorR', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'UorR', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'UorR', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'UorR', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'UorR', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'UorR', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'UorR', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\UorR'))
# combineResults(paste0(directory_path, '\\female\\UorR'), '/rural','rural.csv')
# combineResults(paste0(directory_path, '\\female\\UorR'), '/urban','urban.csv')


#### male ####
setwd(paste0(directory_path, '\\male\\UorR'))

# getSexDetail(HW1_CMA_full, 'UorR', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'UorR', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'UorR', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'UorR', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'UorR', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'UorR', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'UorR', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'UorR', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'UorR', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'UorR', 'HW10', 'male')

# getCSV(paste0(directory_path, '\\male\\UorR'))
# combineResults(paste0(directory_path, '\\male\\UorR'), '/rural','rural.csv')
# combineResults(paste0(directory_path, '\\male\\UorR'), '/urban','urban.csv')


```


```{r marital}
#### female ####
setwd(paste0(directory_path, '\\female\\marital'))

# getSexDetail(HW1_CMA_full, 'marital.baseline', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'marital.baseline', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'marital.baseline', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'marital.baseline', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'marital.baseline', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'marital.baseline', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'marital.baseline', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'marital.baseline', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'marital.baseline', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'marital.baseline', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\marital'))
# combineResults(paste0(directory_path, '\\female\\marital'), '/married','married.csv')
# combineResults(paste0(directory_path, '\\female\\marital'), '/not married','not married.csv')


#### male ####
setwd(paste0(directory_path, '\\male\\marital'))

# getSexDetail(HW1_CMA_full, 'marital.baseline', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'marital.baseline', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'marital.baseline', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'marital.baseline', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'marital.baseline', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'marital.baseline', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'marital.baseline', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'marital.baseline', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'marital.baseline', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'marital.baseline', 'HW10', 'male')
# 
# getCSV(paste0(directory_path, '\\male\\marital'))
# combineResults(paste0(directory_path, '\\male\\marital'), '/married','married.csv')
# combineResults(paste0(directory_path, '\\male\\marital'), '/not married','not married.csv')


```



```{r co.resi}
#### female ####
setwd(paste0(directory_path, '\\female\\coresidence'))

# getSexDetail(HW1_CMA_full, 'co.resi.baseline', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'co.resi.baseline', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'co.resi.baseline', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'co.resi.baseline', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'co.resi.baseline', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'co.resi.baseline', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'co.resi.baseline', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'co.resi.baseline', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'co.resi.baseline', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'co.resi.baseline', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\coresidence'))
# combineResults(paste0(directory_path, '\\female\\coresidence'), '/alone','alone.csv')
# combineResults(paste0(directory_path, '\\female\\coresidence'), '/household','household.csv')
# combineResults(paste0(directory_path, '\\female\\coresidence'), '/institution','institution.csv')


#### male ####
setwd(paste0(directory_path, '\\male\\coresidence'))

# getSexDetail(HW1_CMA_full, 'co.resi.baseline', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'co.resi.baseline', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'co.resi.baseline', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'co.resi.baseline', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'co.resi.baseline', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'co.resi.baseline', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'co.resi.baseline', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'co.resi.baseline', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'co.resi.baseline', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'co.resi.baseline', 'HW10', 'male')
# 
# getCSV(paste0(directory_path, '\\male\\coresidence'))
# combineResults(paste0(directory_path, '\\male\\coresidence'), '/alone','alone.csv')
# combineResults(paste0(directory_path, '\\male\\coresidence'), '/household','household.csv')
# combineResults(paste0(directory_path, '\\male\\coresidence'), '/institution','institution.csv')


```

==================================================================================================================
========================================== sex deonstructed - ses =================================================
================================================================================================================

```{r education}
#### female ####
setwd(paste0(directory_path, '\\female\\education'))

# getSexDetail(HW1_CMA_full, 'education', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'education', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'education', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'education', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'education', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'education', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'education', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'education', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'education', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'education', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\education'))
# combineResults(paste0(directory_path, '\\female\\education'), '/0','0.csv')
# combineResults(paste0(directory_path, '\\female\\education'), '/1-6','1-6.csv')
# combineResults(paste0(directory_path, '\\female\\education'), '/7+','7.csv')


#### male ####
setwd(paste0(directory_path, '\\male\\education'))

# getSexDetail(HW1_CMA_full, 'education', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'education', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'education', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'education', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'education', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'education', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'education', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'education', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'education', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'education', 'HW10', 'male')
# 
# getCSV(paste0(directory_path, '\\male\\education'))
# combineResults(paste0(directory_path, '\\male\\education'), '/0','0.csv')
# combineResults(paste0(directory_path, '\\male\\education'), '/1-6','1-6.csv')
# combineResults(paste0(directory_path, '\\male\\education'), '/7+','7.csv')


```


```{r ocupation}
#### female ####
setwd(paste0(directory_path, '\\female\\occupation'))

# getSexDetail(HW1_CMA_full, 'occupation', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'occupation', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'occupation', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'occupation', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'occupation', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'occupation', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'occupation', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'occupation', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'occupation', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'occupation', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\occupation'))
# combineResults(paste0(directory_path, '\\female\\occupation'), '/agri','agri.csv')
# combineResults(paste0(directory_path, '\\female\\occupation'), '/commer','commer.csv')
# combineResults(paste0(directory_path, '\\female\\occupation'), '/houseworker','houseworker.csv')
# combineResults(paste0(directory_path, '\\female\\occupation'), '/prof','prof.csv')

#### male ####
setwd(paste0(directory_path, '\\male\\occupation'))

# getSexDetail(HW1_CMA_full, 'occupation', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'occupation', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'occupation', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'occupation', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'occupation', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'occupation', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'occupation', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'occupation', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'occupation', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'occupation', 'HW10', 'male')

getCSV(paste0(directory_path, '\\male\\occupation'))
# combineResults(paste0(directory_path, '\\male\\occupation'), '/agri','agri.csv')
# combineResults(paste0(directory_path, '\\male\\occupation'), '/commer','commer.csv')
# combineResults(paste0(directory_path, '\\male\\occupation'), '/houseworker','houseworker.csv')
# combineResults(paste0(directory_path, '\\male\\occupation'), '/prof','prof.csv')



```



==================================================================================================================
========================================== sex deonstructed - disability =================================================
================================================================================================================
```{r mmse}
#### female ####
setwd(paste0(directory_path, '\\female\\mmse'))

# getSexDetail(HW1_CMA_full, 'mmse.status.baseline', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'mmse.status.baseline', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'mmse.status.baseline', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'mmse.status.baseline', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'mmse.status.baseline', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'mmse.status.baseline', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'mmse.status.baseline', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'mmse.status.baseline', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'mmse.status.baseline', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'mmse.status.baseline', 'HW10', 'female')

# getCSV(paste0(directory_path, '\\female\\mmse'))
# combineResults(paste0(directory_path, '\\female\\mmse'), '/poor','poor.csv')
# combineResults(paste0(directory_path, '\\female\\mmse'), '/normal','normal.csv')

#### male ####
setwd(paste0(directory_path, '\\male\\mmse'))

# getSexDetail(HW1_CMA_full, 'mmse.status.baseline', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'mmse.status.baseline', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'mmse.status.baseline', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'mmse.status.baseline', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'mmse.status.baseline', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'mmse.status.baseline', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'mmse.status.baseline', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'mmse.status.baseline', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'mmse.status.baseline', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'mmse.status.baseline', 'HW10', 'male')

# getCSV(paste0(directory_path, '\\male\\mmse'))
# combineResults(paste0(directory_path, '\\male\\mmse'), '/poor','poor.csv')
# combineResults(paste0(directory_path, '\\male\\mmse'), '/normal','normal.csv')


```


```{r iadl_3}
#### female ####
setwd(paste0(directory_path, '\\female\\iadl'))

# getSexDetail(HW1_CMA_full, 'iadl_3', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'iadl_3', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'iadl_3', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'iadl_3', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'iadl_3', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'iadl_3', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'iadl_3', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'iadl_3', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'iadl_3', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'iadl_3', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\iadl'))
# combineResults(paste0(directory_path, '\\female\\iadl'), '/full','full.csv')
# combineResults(paste0(directory_path, '\\female\\iadl'), '/moderate','moderate.csv')
# combineResults(paste0(directory_path, '\\female\\iadl'), '/severe','severe.csv')

#### male ####
setwd(paste0(directory_path, '\\male\\iadl'))

# getSexDetail(HW1_CMA_full, 'iadl_3', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'iadl_3', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'iadl_3', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'iadl_3', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'iadl_3', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'iadl_3', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'iadl_3', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'iadl_3', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'iadl_3', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'iadl_3', 'HW10', 'male')

# getCSV(paste0(directory_path, '\\male\\iadl'))
# combineResults(paste0(directory_path, '\\male\\iadl'), '/full','full.csv')
# combineResults(paste0(directory_path, '\\male\\iadl'), '/moderate','moderate.csv')
# combineResults(paste0(directory_path, '\\male\\iadl'), '/severe','severe.csv')


```


```{r adl.status}
#### female ####
setwd(paste0(directory_path, '\\female\\adl'))

# getSexDetail(HW1_CMA_full, 'adl.status', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'adl.status', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'adl.status', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'adl.status', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'adl.status', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'adl.status', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'adl.status', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'adl.status', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'adl.status', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'adl.status', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\adl'))
# combineResults(paste0(directory_path, '\\female\\adl'), '/full','full.csv')
# combineResults(paste0(directory_path, '\\female\\adl'), '/moderate','moderate.csv')
# combineResults(paste0(directory_path, '\\female\\adl'), '/severe','severe.csv')

#### male ####
setwd(paste0(directory_path, '\\male\\adl'))

# getSexDetail(HW1_CMA_full, 'adl.status', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'adl.status', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'adl.status', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'adl.status', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'adl.status', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'adl.status', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'adl.status', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'adl.status', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'adl.status', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'adl.status', 'HW10', 'male')
# 
# getCSV(paste0(directory_path, '\\male\\adl'))
# combineResults(paste0(directory_path, '\\male\\adl'), '/full','full.csv')
# combineResults(paste0(directory_path, '\\male\\adl'), '/moderate','moderate.csv')
# combineResults(paste0(directory_path, '\\male\\adl'), '/severe','severe.csv')


```




```{r d71}
#### female ####
setwd(paste0(directory_path, '\\female\\d71'))

# getSexDetail(HW1_CMA_full, 'd71', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'd71', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'd71', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'd71', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'd71', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'd71', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'd71', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'd71', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'd71', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'd71', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\d71'))
# combineResults(paste0(directory_path, '\\female\\d71'), '/yes','yes.csv')
# combineResults(paste0(directory_path, '\\female\\d71'), '/no','no.csv')

#### male ####
setwd(paste0(directory_path, '\\male\\d71'))

# getSexDetail(HW1_CMA_full, 'd71', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'd71', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'd71', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'd71', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'd71', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'd71', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'd71', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'd71', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'd71', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'd71', 'HW10', 'male')
# 
# getCSV(paste0(directory_path, '\\male\\d71'))
# combineResults(paste0(directory_path, '\\male\\d71'), '/yes','yes.csv')
# combineResults(paste0(directory_path, '\\male\\d71'), '/no','no.csv')


```


```{r d81}
#### female ####
setwd(paste0(directory_path, '\\female\\d81'))

# getSexDetail(HW1_CMA_full, 'd81', 'HW1', 'female')
# getSexDetail(HW2_WMO_90th_1D_full, 'd81', 'HW2', 'female')
# getSexDetail(HW3_WMO_90th_2D_full, 'd81', 'HW3', 'female')
# getSexDetail(HW4_WMO_90th_3D_full, 'd81', 'HW4', 'female')
# getSexDetail(HW5_WMO_95th_1D_full, 'd81', 'HW5', 'female')
# getSexDetail(HW6_WMO_95th_2D_full, 'd81', 'HW6', 'female')
# getSexDetail(HW7_WMO_95th_3D_full, 'd81', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'd81', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'd81', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'd81', 'HW10', 'female')
# 
# getCSV(paste0(directory_path, '\\female\\d81'))
combineResults(paste0(directory_path, '\\female\\d81'), '/yes','yes.csv')
combineResults(paste0(directory_path, '\\female\\d81'), '/no','no.csv')

#### male ####
setwd(paste0(directory_path, '\\male\\d81'))

# getSexDetail(HW1_CMA_full, 'd81', 'HW1', 'male')
# getSexDetail(HW2_WMO_90th_1D_full, 'd81', 'HW2', 'male')
# getSexDetail(HW3_WMO_90th_2D_full, 'd81', 'HW3', 'male')
# getSexDetail(HW4_WMO_90th_3D_full, 'd81', 'HW4', 'male')
# getSexDetail(HW5_WMO_95th_1D_full, 'd81', 'HW5', 'male')
# getSexDetail(HW6_WMO_95th_2D_full, 'd81', 'HW6', 'male')
# getSexDetail(HW7_WMO_95th_3D_full, 'd81', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10degree_1D_full, 'd81', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10degree_2D_full, 'd81', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10degree_3D_full, 'd81', 'HW10', 'male')
# 
# getCSV(paste0(directory_path, '\\male\\d81'))
combineResults(paste0(directory_path, '\\male\\d81'), '/yes','yes.csv')
combineResults(paste0(directory_path, '\\male\\d81'), '/no','no.csv')

```



===================================================================================
================================= ADL items =====================================
===================================================================================


```{r adl items - bathing}
setwd(paste0(directory_path,'\\female\\bathing'))
# gc()
# getSexDetail(HW1_CMA_full, 'bathing', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'bathing', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'bathing', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'bathing', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'bathing', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'bathing', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'bathing', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'bathing', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'bathing', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'bathing', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\bathing'))
# combineResults(paste0(directory_path,'\\female\\bathing'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\bathing'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\bathing'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\bathing'))
# gc()
# getSexDetail(HW1_CMA_full, 'bathing', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'bathing', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'bathing', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'bathing', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'bathing', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'bathing', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'bathing', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'bathing', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'bathing', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'bathing', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\bathing'))
# combineResults(paste0(directory_path,'\\male\\bathing'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\bathing'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\bathing'), '/full assistance','full assistance.csv')


```


```{r adl items - dressing}
setwd(paste0(directory_path,'\\female\\dressing'))
# gc()
# getSexDetail(HW1_CMA_full, 'dressing', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'dressing', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'dressing', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'dressing', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'dressing', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'dressing', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'dressing', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'dressing', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'dressing', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'dressing', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\dressing'))
# combineResults(paste0(directory_path,'\\female\\dressing'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\dressing'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\dressing'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\dressing'))
# gc()
# getSexDetail(HW1_CMA_full, 'dressing', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'dressing', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'dressing', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'dressing', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'dressing', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'dressing', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'dressing', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'dressing', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'dressing', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'dressing', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\dressing'))
# combineResults(paste0(directory_path,'\\male\\dressing'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\dressing'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\dressing'), '/full assistance','full assistance.csv')


gc()
```


```{r adl items - eating}
setwd(paste0(directory_path,'\\female\\eating'))
# gc()
# getSexDetail(HW1_CMA_full, 'eating', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'eating', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'eating', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'eating', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'eating', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'eating', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'eating', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'eating', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'eating', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'eating', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\eating'))
# combineResults(paste0(directory_path,'\\female\\eating'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\eating'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\eating'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\eating'))
# gc()
# getSexDetail(HW1_CMA_full, 'eating', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'eating', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'eating', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'eating', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'eating', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'eating', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'eating', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'eating', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'eating', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'eating', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\eating'))
# combineResults(paste0(directory_path,'\\male\\eating'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\eating'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\eating'), '/full assistance','full assistance.csv')

gc()
```

```{r adl items - toileting}
setwd(paste0(directory_path,'\\female\\toileting'))
# gc()
# getSexDetail(HW1_CMA_full, 'toileting', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'toileting', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'toileting', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'toileting', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'toileting', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'toileting', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'toileting', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'toileting', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'toileting', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'toileting', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\toileting'))
# combineResults(paste0(directory_path,'\\female\\toileting'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\toileting'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\toileting'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\toileting'))
# gc()
# getSexDetail(HW1_CMA_full, 'toileting', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'toileting', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'toileting', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'toileting', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'toileting', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'toileting', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'toileting', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'toileting', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'toileting', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'toileting', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\toileting'))
# combineResults(paste0(directory_path,'\\male\\toileting'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\toileting'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\toileting'), '/full assistance','full assistance.csv')

gc()
```



```{r adl items - indoormoving}
setwd(paste0(directory_path,'\\female\\indoormoving'))
# gc()
# getSexDetail(HW1_CMA_full, 'indoormoving', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'indoormoving', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'indoormoving', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'indoormoving', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'indoormoving', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'indoormoving', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'indoormoving', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'indoormoving', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'indoormoving', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'indoormoving', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\indoormoving'))
# combineResults(paste0(directory_path,'\\female\\indoormoving'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\indoormoving'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\indoormoving'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\indoormoving'))
# gc()
# getSexDetail(HW1_CMA_full, 'indoormoving', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'indoormoving', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'indoormoving', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'indoormoving', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'indoormoving', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'indoormoving', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'indoormoving', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'indoormoving', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'indoormoving', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'indoormoving', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\indoormoving'))
# combineResults(paste0(directory_path,'\\male\\indoormoving'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\indoormoving'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\indoormoving'), '/full assistance','full assistance.csv')
```


```{r adl items - continence}
setwd(paste0(directory_path,'\\female\\continence'))
# gc()
# getSexDetail(HW1_CMA_full, 'continence', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'continence', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'continence', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'continence', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'continence', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'continence', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'continence', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'continence', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'continence', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'continence', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\continence'))
# combineResults(paste0(directory_path,'\\female\\continence'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\continence'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\continence'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\continence'))
# gc()
# getSexDetail(HW1_CMA_full, 'continence', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'continence', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'continence', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'continence', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'continence', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'continence', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'continence', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'continence', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'continence', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'continence', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\continence'))
# combineResults(paste0(directory_path,'\\male\\continence'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\continence'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\continence'), '/full assistance','full assistance.csv')

gc()
```






###########################################################################
######################### IADL ITEMS#######################################
###########################################################################
```{r iadl items - neighbour}
setwd(paste0(directory_path,'\\female\\iadl items\\neighbour'))
# gc()
# getSexDetail(HW1_CMA_full, 'neighbour', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'neighbour', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'neighbour', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'neighbour', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'neighbour', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'neighbour', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'neighbour', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'neighbour', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'neighbour', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'neighbour', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\neighbour'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\neighbour'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\neighbour'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\neighbour'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\neighbour'))
# gc()
# getSexDetail(HW1_CMA_full, 'neighbour', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'neighbour', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'neighbour', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'neighbour', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'neighbour', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'neighbour', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'neighbour', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'neighbour', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'neighbour', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'neighbour', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\neighbour'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\neighbour'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\neighbour'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\neighbour'), '/full assistance','full assistance.csv')

gc()
```


```{r iadl items - laundry}
setwd(paste0(directory_path,'\\female\\iadl items\\laundry'))
# gc()
# getSexDetail(HW1_CMA_full, 'laundry', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'laundry', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'laundry', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'laundry', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'laundry', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'laundry', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'laundry', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'laundry', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'laundry', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'laundry', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\laundry'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\laundry'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\laundry'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\laundry'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\laundry'))
# gc()
# getSexDetail(HW1_CMA_full, 'laundry', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'laundry', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'laundry', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'laundry', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'laundry', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'laundry', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'laundry', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'laundry', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'laundry', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'laundry', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\laundry'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\laundry'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\laundry'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\laundry'), '/full assistance','full assistance.csv')

gc()
```


```{r iadl items - cooking}
setwd(paste0(directory_path,'\\female\\iadl items\\cooking'))
# gc()
# getSexDetail(HW1_CMA_full, 'cooking', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'cooking', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'cooking', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'cooking', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'cooking', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'cooking', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'cooking', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'cooking', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'cooking', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'cooking', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\cooking'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\cooking'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\cooking'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\cooking'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\cooking'))
# gc()
# getSexDetail(HW1_CMA_full, 'cooking', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'cooking', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'cooking', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'cooking', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'cooking', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'cooking', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'cooking', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'cooking', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'cooking', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'cooking', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\cooking'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\cooking'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\cooking'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\cooking'), '/full assistance','full assistance.csv')

gc()
```


```{r iadl items - carry5kg}
setwd(paste0(directory_path,'\\female\\iadl items\\carry5kg'))
# gc()
# getSexDetail(HW1_CMA_full, 'carry5kg', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'carry5kg', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'carry5kg', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'carry5kg', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'carry5kg', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'carry5kg', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'carry5kg', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'carry5kg', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'carry5kg', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'carry5kg', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\carry5kg'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\carry5kg'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\carry5kg'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\carry5kg'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\carry5kg'))
# gc()
# getSexDetail(HW1_CMA_full, 'carry5kg', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'carry5kg', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'carry5kg', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'carry5kg', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'carry5kg', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'carry5kg', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'carry5kg', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'carry5kg', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'carry5kg', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'carry5kg', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\carry5kg'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\carry5kg'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\carry5kg'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\carry5kg'), '/full assistance','full assistance.csv')

gc()
```



```{r iadl items - walk1km}
setwd(paste0(directory_path,'\\female\\iadl items\\walk1km'))
# gc()
# getSexDetail(HW1_CMA_full, 'walk1km', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'walk1km', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'walk1km', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'walk1km', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'walk1km', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'walk1km', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'walk1km', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'walk1km', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'walk1km', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'walk1km', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\walk1km'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\walk1km'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\walk1km'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\walk1km'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\walk1km'))
# gc()
# getSexDetail(HW1_CMA_full, 'walk1km', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'walk1km', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'walk1km', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'walk1km', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'walk1km', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'walk1km', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'walk1km', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'walk1km', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'walk1km', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'walk1km', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\walk1km'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\walk1km'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\walk1km'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\walk1km'), '/full assistance','full assistance.csv')

gc()
```



```{r iadl items - crouch}
setwd(paste0(directory_path,'\\female\\iadl items\\crouch'))
# gc()
# getSexDetail(HW1_CMA_full, 'crouch', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'crouch', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'crouch', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'crouch', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'crouch', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'crouch', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'crouch', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'crouch', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'crouch', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'crouch', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\crouch'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\crouch'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\crouch'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\crouch'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\crouch'))
# gc()
# getSexDetail(HW1_CMA_full, 'crouch', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'crouch', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'crouch', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'crouch', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'crouch', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'crouch', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'crouch', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'crouch', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'crouch', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'crouch', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\crouch'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\crouch'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\crouch'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\crouch'), '/full assistance','full assistance.csv')

gc()
```



```{r iadl items - shopping}
setwd(paste0(directory_path,'\\female\\iadl items\\shopping'))
# gc()
# getSexDetail(HW1_CMA_full, 'shopping', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'shopping', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'shopping', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'shopping', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'shopping', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'shopping', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'shopping', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'shopping', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'shopping', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'shopping', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\shopping'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\shopping'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\shopping'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\shopping'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\shopping'))
# gc()
# getSexDetail(HW1_CMA_full, 'shopping', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'shopping', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'shopping', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'shopping', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'shopping', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'shopping', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'shopping', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'shopping', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'shopping', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'shopping', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\shopping'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\shopping'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\shopping'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\shopping'), '/full assistance','full assistance.csv')

gc()
```


```{r iadl items - transfer}
setwd(paste0(directory_path,'\\female\\iadl items\\transfer'))
# gc()
# getSexDetail(HW1_CMA_full, 'e14', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'e14', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'e14', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'e14', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'e14', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'e14', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'e14', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'e14', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'e14', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'e14', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\iadl items\\transfer'))
# combineResults(paste0(directory_path,'\\female\\iadl items\\transfer'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\transfer'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\iadl items\\transfer'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\iadl items\\transfer'))
# gc()
# getSexDetail(HW1_CMA_full, 'e14', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'e14', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'e14', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'e14', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'e14', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'e14', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'e14', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'e14', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'e14', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'e14', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\iadl items\\transfer'))
# combineResults(paste0(directory_path,'\\male\\iadl items\\transfer'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\transfer'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\iadl items\\transfer'), '/full assistance','full assistance.csv')

gc()
```

###########################################################################
######################### MMSE ITEMS#######################################
###########################################################################

```{R split into tertiles}
getItemTertiles = function(df){
  
  df %>%
  mutate(orientation_binary = ifelse(orientation >= median(orientation), "better", "worse"),
    registration_binary = ifelse(registration >= median(registration), "better", "worse"),
    calculation_binary = ifelse(calculation >= median(calculation), "better", "worse"),
    recall_binary = ifelse(recall >= median(recall), "better", "worse"),
    language_binary = ifelse(language >= median(language), "better", "worse")
         
         ) -> df
  
  return(df)
}



# getItemTertiles(HW1_CMA_full) -> HW1_CMA_full
# getItemTertiles(HW2_WMO_90TH_1D_full) -> HW2_WMO_90TH_1D_full
# getItemTertiles(HW3_WMO_90TH_2D_full) -> HW3_WMO_90TH_2D_full
# getItemTertiles(HW4_WMO_90TH_3D_full) -> HW4_WMO_90TH_3D_full
# getItemTertiles(HW5_WMO_95TH_1D_full) -> HW5_WMO_95TH_1D_full
# getItemTertiles(HW6_WMO_95TH_2D_full) -> HW6_WMO_95TH_2D_full
# getItemTertiles(HW7_WMO_95TH_3D_full) -> HW7_WMO_95TH_3D_full
# getItemTertiles(HW8_NOAA_10C_1D_full) -> HW8_NOAA_10C_1D_full
# getItemTertiles(HW9_NOAA_10C_2D_full) -> HW9_NOAA_10C_2D_full
# getItemTertiles(HW10_NOAA_10C_3D_full) -> HW10_NOAA_10C_3D_full

#head(HW6_WMO_95TH_2D_full)
```


```{r calculation}
setwd(paste0(directory_path,'\\female\\MMSE items\\calculation'))
# gc()
# getSexDetail(HW1_CMA_full, 'calculation', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'calculation', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'calculation', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'calculation', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'calculation', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'calculation', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'calculation', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'calculation', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'calculation', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'calculation', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\MMSE items\\calculation'))
# combineResults(paste0(directory_path,'\\female\\MMSE items\\calculation'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\calculation'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\calculation'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\MMSE items\\calculation'))
# gc()
# getSexDetail(HW1_CMA_full, 'calculation', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'calculation', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'calculation', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'calculation', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'calculation', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'calculation', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'calculation', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'calculation', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'calculation', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'calculation', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\MMSE items\\calculation'))
# combineResults(paste0(directory_path,'\\male\\MMSE items\\calculation'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\calculation'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\calculation'), '/full assistance','full assistance.csv')

gc()

```


```{r orientation}
setwd(paste0(directory_path,'\\female\\MMSE items\\orientation'))
# gc()
# getSexDetail(HW1_CMA_full, 'orientation', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'orientation', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'orientation', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'orientation', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'orientation', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'orientation', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'orientation', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'orientation', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'orientation', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'orientation', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\MMSE items\\orientation'))
# combineResults(paste0(directory_path,'\\female\\MMSE items\\orientation'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\orientation'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\orientation'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\MMSE items\\orientation'))
# gc()
# getSexDetail(HW1_CMA_full, 'orientation', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'orientation', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'orientation', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'orientation', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'orientation', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'orientation', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'orientation', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'orientation', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'orientation', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'orientation', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\MMSE items\\orientation'))
# combineResults(paste0(directory_path,'\\male\\MMSE items\\orientation'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\orientation'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\orientation'), '/full assistance','full assistance.csv')

gc()

```




```{r registration}
setwd(paste0(directory_path,'\\female\\MMSE items\\registration'))
# gc()
# getSexDetail(HW1_CMA_full, 'registration', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'registration', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'registration', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'registration', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'registration', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'registration', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'registration', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'registration', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'registration', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'registration', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\MMSE items\\registration'))
# combineResults(paste0(directory_path,'\\female\\MMSE items\\registration'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\registration'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\registration'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\MMSE items\\registration'))
# gc()
# getSexDetail(HW1_CMA_full, 'registration', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'registration', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'registration', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'registration', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'registration', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'registration', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'registration', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'registration', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'registration', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'registration', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\MMSE items\\registration'))
# combineResults(paste0(directory_path,'\\male\\MMSE items\\registration'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\registration'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\registration'), '/full assistance','full assistance.csv')

gc()

```


```{r recall}
setwd(paste0(directory_path,'\\female\\MMSE items\\recall'))
# gc()
# getSexDetail(HW1_CMA_full, 'recall', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'recall', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'recall', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'recall', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'recall', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'recall', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'recall', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'recall', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'recall', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'recall', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\MMSE items\\recall'))
# combineResults(paste0(directory_path,'\\female\\MMSE items\\recall'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\recall'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\recall'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\MMSE items\\recall'))
# gc()
# getSexDetail(HW1_CMA_full, 'recall', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'recall', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'recall', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'recall', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'recall', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'recall', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'recall', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'recall', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'recall', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'recall', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\MMSE items\\recall'))
# combineResults(paste0(directory_path,'\\male\\MMSE items\\recall'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\recall'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\recall'), '/full assistance','full assistance.csv')

gc()

```



```{r language}

setwd(paste0(directory_path,'\\female\\MMSE items\\language'))
# gc()
# getSexDetail(HW1_CMA_full, 'language', 'HW1', 'female')
# getSexDetail(HW2_WMO_90TH_1D_full, 'language', 'HW2', 'female')
# getSexDetail(HW3_WMO_90TH_2D_full, 'language', 'HW3', 'female')
# getSexDetail(HW4_WMO_90TH_3D_full, 'language', 'HW4', 'female')
# getSexDetail(HW5_WMO_95TH_1D_full, 'language', 'HW5', 'female')
# getSexDetail(HW6_WMO_95TH_2D_full, 'language', 'HW6', 'female')
# getSexDetail(HW7_WMO_95TH_3D_full, 'language', 'HW7', 'female')
# getSexDetail(HW8_NOAA_10C_1D_full, 'language', 'HW8', 'female')
# getSexDetail(HW9_NOAA_10C_2D_full, 'language', 'HW9', 'female')
# getSexDetail(HW10_NOAA_10C_3D_full, 'language', 'HW10', 'female')
# 
# getCSV(paste0(directory_path,'\\female\\MMSE items\\language'))
# combineResults(paste0(directory_path,'\\female\\MMSE items\\language'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\language'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\female\\MMSE items\\language'), '/full assistance','full assistance.csv')



setwd(paste0(directory_path,'\\male\\MMSE items\\language'))
# gc()
# getSexDetail(HW1_CMA_full, 'language', 'HW1', 'male')
# getSexDetail(HW2_WMO_90TH_1D_full, 'language', 'HW2', 'male')
# getSexDetail(HW3_WMO_90TH_2D_full, 'language', 'HW3', 'male')
# getSexDetail(HW4_WMO_90TH_3D_full, 'language', 'HW4', 'male')
# getSexDetail(HW5_WMO_95TH_1D_full, 'language', 'HW5', 'male')
# getSexDetail(HW6_WMO_95TH_2D_full, 'language', 'HW6', 'male')
# getSexDetail(HW7_WMO_95TH_3D_full, 'language', 'HW7', 'male')
# getSexDetail(HW8_NOAA_10C_1D_full, 'language', 'HW8', 'male')
# getSexDetail(HW9_NOAA_10C_2D_full, 'language', 'HW9', 'male')
# getSexDetail(HW10_NOAA_10C_3D_full, 'language', 'HW10', 'male')
# 
# getCSV(paste0(directory_path,'\\male\\MMSE items\\language'))
# combineResults(paste0(directory_path,'\\male\\MMSE items\\language'), '/without assistance', 'without assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\language'), '/partial assistance','partial assistance.csv')
# combineResults(paste0(directory_path,'\\male\\MMSE items\\language'), '/full assistance','full assistance.csv')

gc()

```




